(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[542],{7450:function(t,e,n){Promise.resolve().then(n.bind(n,779))},779:function(t,e,n){"use strict";n.d(e,{default:function(){return d}});var i=n(7437),a=n(2265),u=n(4842),s=n(9262),r=n(7240),o=n(4493),l=n(6649);class c extends l.G{constructor({value:t}){super(`Number \`${t}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function p(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new c({value:t});let[n,i="0"]=t.split("."),a=n.startsWith("-");if(a&&(n=n.slice(1)),i=i.replace(/(0+)$/,""),0===e)1===Math.round(Number(`.${i}`))&&(n=`${BigInt(n)+1n}`),i="";else if(i.length>e){let[t,a,u]=[i.slice(0,e-1),i.slice(e-1,e),i.slice(e)],s=Math.round(Number(`${a}.${u}`));(i=s>9?`${BigInt(t)+BigInt(1)}0`.padStart(t.length+1,"0"):`${t}${s}`).length>e&&(i=i.slice(1),n=`${BigInt(n)+1n}`),i=i.slice(0,e)}else i=i.padEnd(e,"0");return BigInt(`${a?"-":""}${n}${i}`)}var m=n(2921);function d(){let{address:t,isConnected:e}=(0,u.m)(),[n,l]=(0,a.useState)(""),{data:c}=(0,s.u)({address:o.LZ,abi:o.ll,functionName:"currentPhase"}),{data:d}=(0,s.u)({address:o.LZ,abi:o.ll,functionName:"phaseConfigs",args:[Number(null!=c?c:0)]}),y=(null==d?void 0:d[0])?BigInt(d[0]):void 0,f=(null==d?void 0:d[3])?Number(d[3]):0,b=(null==d?void 0:d[1])?BigInt(d[1]):void 0,v=(null==d?void 0:d[2])?BigInt(d[2]):void 0,h=(0,a.useMemo)(()=>{if(!y||!n)return"0";try{let t=p(n,6)*10n**18n/y,e=t+t*BigInt(f)/100n;return(0,m.b)(e,18)}catch(t){return"0"}},[y,f,n]),{data:N}=(0,s.u)(t&&o.iu&&o.LZ?{address:o.iu,abi:o.RB,functionName:"allowance",args:[t,o.LZ]}:void 0),[x,g]=(0,a.useState)(!1),[T,_]=(0,a.useState)(!1),[w,P]=(0,a.useState)(),{writeContract:B,isPending:C}=(0,r.S)(),I=async()=>{try{if(P(void 0),!e||!y)return;let t=p(n||"0",6);if(0n===t)return;if(b&&t<b){P("Amount is below minimum purchase for this phase");return}if(v&&t>v){P("Amount exceeds maximum purchase for this phase");return}(null!=N?N:0n)<t&&(await B({address:o.iu,abi:o.RB,functionName:"approve",args:[o.LZ,t]}),g(!0)),await B({address:o.LZ,abi:o.ll,functionName:"buyTokens",args:[t]}),_(!0)}catch(t){P((null==t?void 0:t.shortMessage)||(null==t?void 0:t.message)||"Transaction failed")}};return(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"text-sm text-zinc-400",children:["Phase: ","number"==typeof c?c:Number(null!=c?c:0)]}),(0,i.jsx)("label",{className:"block text-sm",children:"USDT Amount"}),(0,i.jsx)("input",{className:"w-full bg-zinc-800 rounded px-3 py-2",placeholder:"1000",value:n,onChange:t=>l(t.target.value)}),(0,i.jsxs)("div",{className:"text-sm text-zinc-400",children:["GTK Received (est): ",h]}),w&&(0,i.jsx)("div",{className:"text-sm text-red-400",children:w}),x&&(0,i.jsx)("div",{className:"text-xs text-zinc-400",children:"Approval submitted. Waiting for confirmation in your wallet."}),T&&(0,i.jsx)("div",{className:"text-xs text-zinc-400",children:"Purchase submitted. Check your wallet for status."}),(0,i.jsx)("button",{onClick:I,disabled:!e||C||!n,className:"bg-primary px-4 py-2 rounded disabled:opacity-50",children:C?"Processing...":"Approve & Purchase"})]})}},4493:function(t,e,n){"use strict";n.d(e,{Bg:function(){return c},LZ:function(){return u},RB:function(){return o},iu:function(){return r},jT:function(){return s},jv:function(){return a},ll:function(){return l}});var i=n(357);let a=i.env.NEXT_PUBLIC_GTK_TOKEN_ADDRESS,u=i.env.NEXT_PUBLIC_ICO_CONTRACT_ADDRESS,s=i.env.NEXT_PUBLIC_TOURNAMENT_CONTRACT_ADDRESS,r=i.env.NEXT_PUBLIC_USDT_ADDRESS,o=[{inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],name:"approve",outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{type:"uint8"}],stateMutability:"view",type:"function"}],l=[{inputs:[],name:"currentPhase",outputs:[{type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{name:"",type:"uint8"}],name:"phaseConfigs",outputs:[{name:"tokenPrice",type:"uint256"},{name:"minPurchase",type:"uint256"},{name:"maxPurchase",type:"uint256"},{name:"bonusPercent",type:"uint256"},{name:"allocation",type:"uint256"},{name:"sold",type:"uint256"},{name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{name:"usdtAmount",type:"uint256"}],name:"buyTokens",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimTokens",outputs:[],stateMutability:"nonpayable",type:"function"}],c=[{inputs:[{name:"",type:"uint256"}],name:"tournaments",outputs:[{name:"id",type:"uint256"},{name:"name",type:"string"},{name:"entryFee",type:"uint256"},{name:"prizePool",type:"uint256"},{name:"maxParticipants",type:"uint256"},{name:"currentParticipants",type:"uint256"},{name:"startTime",type:"uint256"},{name:"endTime",type:"uint256"},{name:"isActive",type:"bool"},{name:"isCompleted",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{name:"_tournamentId",type:"uint256"}],name:"joinTournament",outputs:[],stateMutability:"nonpayable",type:"function"}]}},function(t){t.O(0,[928,733,971,23,744],function(){return t(t.s=7450)}),_N_E=t.O()}]);